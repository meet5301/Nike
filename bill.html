<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Bill | Nike</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #f2f2f2;
      margin: 0;
      padding: 40px;
    }

    .bill-container {
      max-width: 900px;
      margin: auto;
      background: #fff;
      padding: 40px;
      border-radius: 10px;
      box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
    }

    h1, h2 {
      text-align: center;
    }

    .bill-header, .bill-items, .bill-total {
      margin-bottom: 30px;
    }

    .bill-header div {
      margin: 5px 0;
    }

    .bill-items .item-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      border-bottom: 1px solid #ccc;
      padding: 10px 0;
    }

    .item-row img {
      width: 70px;
      height: auto;
      margin-right: 15px;
      border-radius: 6px;
    }

    .item-details {
      flex: 1;
      display: flex;
      align-items: center;
    }

    .item-title {
      font-weight: bold;
    }

    .bill-total {
      font-weight: bold;
      font-size: 18px;
      text-align: right;
    }

    .scanner {
      text-align: center;
      margin: 30px 0;
    }

    .scanner img {
      width: 150px;
      height: auto;
    }

    .payment-options {
      text-align: center;
      margin-top: 30px;
    }

    .payment-options button,
    .action-btn {
      margin: 10px;
      padding: 12px 20px;
      font-size: 16px;
      cursor: pointer;
      border: none;
      border-radius: 6px;
      color: white;
    }

    .payment-options button {
      background: #000;
    }

    .download-btn {
      background-color: rgb(238, 107, 47);
    }

    .back-btn {
      background-color: rgb(238, 107, 47);
      text-decoration: none;
      display: inline-block;
    }

    .actions {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-top: 30px;
    }

    .back-btn:hover,
    .download-btn:hover,
    .payment-options button:hover {
      opacity: 0.9;
    }
  </style>
</head>
<body>

  <div id="billContent" class="bill-container">
    <h1>Nike Purchase Bill</h1>

    <div class="bill-header">
      <div><strong>Name:</strong> <span id="customerName"></span></div>
      <div><strong>Date:</strong> <span id="dateNow"></span></div>
    </div>

    <h2>Items</h2>
    <div class="bill-items" id="itemsList"></div>

    <div class="bill-total">
      Total: $<span id="totalBill"></span>
    </div>

    <div class="scanner">
      <h3>Scan to Pay</h3>
      <img src="https://api.qrserver.com/v1/create-qr-code/?data=NikePayment&size=150x150" alt="QR Code">
    </div>

    <div class="payment-options">
      <h3>Choose a Payment Option</h3>
      <button onclick="alert('Paid via UPI!')">UPI</button>
      <button onclick="alert('Paid via Card!')">Card</button>
      <button onclick="alert('Paid via Net Banking!')">Net Banking</button>
      <button onclick="alert('Cash on Delivery selected!')">COD</button>
    </div>
  </div>

  <div class="actions">
    <button class="download-btn action-btn" onclick="downloadBill()">Download PDF</button>
    <button class="back-btn action-btn" onclick="clearCartAndGoBack()">Back to Shop</button>
  </div>

  <script>
    const cart = JSON.parse(localStorage.getItem("finalCart")) || [];
    const customer = JSON.parse(localStorage.getItem("loggedInUser"));
    const itemsList = document.getElementById("itemsList");
    const totalEl = document.getElementById("totalBill");
    const dateNow = document.getElementById("dateNow");
    const nameEl = document.getElementById("customerName");

    let total = 0;
    nameEl.textContent = customer?.username || "Guest";
    dateNow.textContent = new Date().toLocaleString();

    cart.forEach(item => {
      total += item.price;
      const itemRow = document.createElement("div");
      itemRow.className = "item-row";
      itemRow.innerHTML = `
        <div class="item-details">
          <img src="${item.img}" alt="${item.title}">
          <div>
            <div class="item-title">${item.title}</div>
            <div>Size: US ${item.size || '-'}</div>
          </div>
        </div>
        <div>$${item.price}</div>
      `;
      itemsList.appendChild(itemRow);
    });

    totalEl.textContent = total.toFixed(2);

    function downloadBill() {
      const billElement = document.getElementById("billContent");
      html2pdf()
        .from(billElement)
        .save("Nike-Bill.pdf")
        .then(() => {
          localStorage.removeItem("cart");
          localStorage.removeItem("finalCart");
        });
    }

    function clearCartAndGoBack() {
      localStorage.removeItem("cart");
      localStorage.removeItem("finalCart");
      window.location.href = "cart.html";
    }
  </script>

</body>
</html>
